function b=genQCHSHNM(Joint_P,Marg_PA,Marg_PB,eta)etaB=eta;etaA=eta;Q1 = ones(4,9);for as = 0:1    for bs = 0:1        for ao = 0:1            Q1(2 * as + bs + 1 , 3 * ao + 3) = etaA * (1-etaB) * Marg_PA{ao+1,as+1} ;        end        for bo = 0:1            Q1(2 * as + bs + 1 , 3 * 2 + bo + 1) = etaB * (1-etaA) * Marg_PB{bo+1,bs+1};        end    endendfor as = 0:1	for bs = 0:1					Q1(2 * as + bs + 1, 9) = (1 - etaA) *  (1-etaB);			for ao = 0:1      for bo = 0:1        Q1(2 * as + bs + 1 , 3 * ao + bo + 1) = Joint_P{ao+1,bo+1,as+1,bs+1} * etaA * etaB;							end		end  endendb = reshape(Q1, 1, []);endfunction
